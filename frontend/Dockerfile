FROM node:20-slim AS build
ARG VITE_API_URL
ARG VITE_NAVER_URL
ARG VITE_FCM_KEY
ARG VITE_FCM_API_KEY
ARG VITE_FCM_AUTH_DOMAIN
ARG VITE_FCM_PROJECT_ID
ARG VITE_FCM_STORAGE_BUCKET
ARG VITE_FCM_MESSAGING_SENDER_ID
ARG VITE_FCM_APP_ID
ARG VITE_FCM_MEASUREMENT_ID
ARG VITE_OCR_URL
ARG VITE_SECRET_KEY
ARG VITE_AI_API_URL



ENV VITE_API_URL=${VITE_API_URL}
ENV VITE_NAVER_URL=${VITE_NAVER_URL}
ENV VITE_FCM_KEY=${VITE_FCM_KEY}
ENV VITE_FCM_API_KEY=${VITE_FCM_API_KEY}
ENV VITE_FCM_AUTH_DOMAIN=${VITE_FCM_AUTH_DOMAIN}
ENV VITE_FCM_PROJECT_ID=${VITE_FCM_PROJECT_ID}
ENV VITE_FCM_STORAGE_BUCKET=${VITE_FCM_STORAGE_BUCKET}
ENV VITE_FCM_MESSAGING_SENDER_ID=${VITE_FCM_MESSAGING_SENDER_ID}
ENV VITE_FCM_APP_ID=${VITE_FCM_APP_ID}
ENV VITE_FCM_MEASUREMENT_ID=${VITE_FCM_MEASUREMENT_ID}
ENV VITE_OCR_URL=${VITE_OCR_URL}
ENV VITE_SECRET_KEY=${VITE_SECRET_KEY}
ENV VITE_AI_API_URL=${VITE_AI_API_URL}



WORKDIR /app
COPY package*.json ./
RUN npm install vite@4.4.0
RUN npm install firebase
RUN npm install vite-plugin-pwa
RUN npm install sockjs-client@latest
RUN npm install stompjs@latest
RUN npm install
RUN npm install -g serve
COPY . .
RUN npm run build
CMD ["serve","-s","dist","-l","5173"]
EXPOSE 5173
